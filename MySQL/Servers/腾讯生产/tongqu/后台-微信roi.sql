SELECT
    r.app_id, g.name, date_at,
    MAX(ad_cost) ad_cost,
    MAX(CASE WHEN date_after = 0 THEN ad_roi END) AS roi1,
    MAX(CASE WHEN date_after = 1 THEN ad_roi END) AS roi2,
    MAX(CASE WHEN date_after = 2 THEN ad_roi END) AS roi3,
    MAX(CASE WHEN date_after = 3 THEN ad_roi END) AS roi4,
    MAX(CASE WHEN date_after = 4 THEN ad_roi END) AS roi5,
    MAX(CASE WHEN date_after = 5 THEN ad_roi END) AS roi6,
    MAX(CASE WHEN date_after = 6 THEN ad_roi END) AS roi7,
    MAX(CASE WHEN date_after = 7 THEN ad_roi END) AS roi8,
    MAX(CASE WHEN date_after = 8 THEN ad_roi END) AS roi9,
    MAX(CASE WHEN date_after = 9 THEN ad_roi END) AS roi10,
    MAX(CASE WHEN date_after = 10 THEN ad_roi END) AS roi11,
    MAX(CASE WHEN date_after = 11 THEN ad_roi END) AS roi12,
    MAX(CASE WHEN date_after = 12 THEN ad_roi END) AS roi13,
    MAX(CASE WHEN date_after = 13 THEN ad_roi END) AS roi14,
    MAX(CASE WHEN date_after = 14 THEN ad_roi END) AS roi15,
    MAX(CASE WHEN date_after = 15 THEN ad_roi END) AS roi16,
    MAX(CASE WHEN date_after = 16 THEN ad_roi END) AS roi17,
    MAX(CASE WHEN date_after = 17 THEN ad_roi END) AS roi18,
    MAX(CASE WHEN date_after = 18 THEN ad_roi END) AS roi19,
    MAX(CASE WHEN date_after = 19 THEN ad_roi END) AS roi20,
    MAX(CASE WHEN date_after = 20 THEN ad_roi END) AS roi21,
    MAX(CASE WHEN date_after = 21 THEN ad_roi END) AS roi22,
    MAX(CASE WHEN date_after = 22 THEN ad_roi END) AS roi23,
    MAX(CASE WHEN date_after = 23 THEN ad_roi END) AS roi24,
    MAX(CASE WHEN date_after = 24 THEN ad_roi END) AS roi25,
    MAX(CASE WHEN date_after = 25 THEN ad_roi END) AS roi26,
    MAX(CASE WHEN date_after = 26 THEN ad_roi END) AS roi27,
    MAX(CASE WHEN date_after = 27 THEN ad_roi END) AS roi28,
    MAX(CASE WHEN date_after = 28 THEN ad_roi END) AS roi29,
    MAX(CASE WHEN date_after = 29 THEN ad_roi END) AS roi30,
    MAX(CASE WHEN date_after = 30 THEN ad_roi END) AS roi31,
    MAX(CASE WHEN date_after = 31 THEN ad_roi END) AS roi32,
    MAX(CASE WHEN date_after = 32 THEN ad_roi END) AS roi33,
    MAX(CASE WHEN date_after = 33 THEN ad_roi END) AS roi34,
    MAX(CASE WHEN date_after = 34 THEN ad_roi END) AS roi35,
    MAX(CASE WHEN date_after = 35 THEN ad_roi END) AS roi36,
    MAX(CASE WHEN date_after = 36 THEN ad_roi END) AS roi37,
    MAX(CASE WHEN date_after = 37 THEN ad_roi END) AS roi38,
    MAX(CASE WHEN date_after = 38 THEN ad_roi END) AS roi39,
    MAX(CASE WHEN date_after = 39 THEN ad_roi END) AS roi40,
    MAX(CASE WHEN date_after = 40 THEN ad_roi END) AS roi41,
    MAX(CASE WHEN date_after = 41 THEN ad_roi END) AS roi42,
    MAX(CASE WHEN date_after = 42 THEN ad_roi END) AS roi43,
    MAX(CASE WHEN date_after = 43 THEN ad_roi END) AS roi44,
    MAX(CASE WHEN date_after = 44 THEN ad_roi END) AS roi45,
    MAX(CASE WHEN date_after = 45 THEN ad_roi END) AS roi46,
    MAX(CASE WHEN date_after = 46 THEN ad_roi END) AS roi47,
    MAX(CASE WHEN date_after = 47 THEN ad_roi END) AS roi48,
    MAX(CASE WHEN date_after = 48 THEN ad_roi END) AS roi49,
    MAX(CASE WHEN date_after = 49 THEN ad_roi END) AS roi50,
    MAX(CASE WHEN date_after = 50 THEN ad_roi END) AS roi51,
    MAX(CASE WHEN date_after = 51 THEN ad_roi END) AS roi52,
    MAX(CASE WHEN date_after = 52 THEN ad_roi END) AS roi53,
    MAX(CASE WHEN date_after = 53 THEN ad_roi END) AS roi54,
    MAX(CASE WHEN date_after = 54 THEN ad_roi END) AS roi55,
    MAX(CASE WHEN date_after = 55 THEN ad_roi END) AS roi56,
    MAX(CASE WHEN date_after = 56 THEN ad_roi END) AS roi57,
    MAX(CASE WHEN date_after = 57 THEN ad_roi END) AS roi58,
    MAX(CASE WHEN date_after = 58 THEN ad_roi END) AS roi59,
    MAX(CASE WHEN date_after = 59 THEN ad_roi END) AS roi60,
    MAX(CASE WHEN date_after = 60 THEN ad_roi END) AS roi61,
    MAX(CASE WHEN date_after = 61 THEN ad_roi END) AS roi62,
    MAX(CASE WHEN date_after = 62 THEN ad_roi END) AS roi63,
    MAX(CASE WHEN date_after = 63 THEN ad_roi END) AS roi64,
    MAX(CASE WHEN date_after = 64 THEN ad_roi END) AS roi65,
    MAX(CASE WHEN date_after = 65 THEN ad_roi END) AS roi66,
    MAX(CASE WHEN date_after = 66 THEN ad_roi END) AS roi67,
    MAX(CASE WHEN date_after = 67 THEN ad_roi END) AS roi68,
    MAX(CASE WHEN date_after = 68 THEN ad_roi END) AS roi69,
    MAX(CASE WHEN date_after = 69 THEN ad_roi END) AS roi70,
    MAX(CASE WHEN date_after = 70 THEN ad_roi END) AS roi71,
    MAX(CASE WHEN date_after = 71 THEN ad_roi END) AS roi72,
    MAX(CASE WHEN date_after = 72 THEN ad_roi END) AS roi73,
    MAX(CASE WHEN date_after = 73 THEN ad_roi END) AS roi74,
    MAX(CASE WHEN date_after = 74 THEN ad_roi END) AS roi75,
    MAX(CASE WHEN date_after = 75 THEN ad_roi END) AS roi76,
    MAX(CASE WHEN date_after = 76 THEN ad_roi END) AS roi77,
    MAX(CASE WHEN date_after = 77 THEN ad_roi END) AS roi78,
    MAX(CASE WHEN date_after = 78 THEN ad_roi END) AS roi79,
    MAX(CASE WHEN date_after = 79 THEN ad_roi END) AS roi80,
    MAX(CASE WHEN date_after = 80 THEN ad_roi END) AS roi81,
    MAX(CASE WHEN date_after = 81 THEN ad_roi END) AS roi82,
    MAX(CASE WHEN date_after = 82 THEN ad_roi END) AS roi83,
    MAX(CASE WHEN date_after = 83 THEN ad_roi END) AS roi84,
    MAX(CASE WHEN date_after = 84 THEN ad_roi END) AS roi85,
    MAX(CASE WHEN date_after = 85 THEN ad_roi END) AS roi86,
    MAX(CASE WHEN date_after = 86 THEN ad_roi END) AS roi87,
    MAX(CASE WHEN date_after = 87 THEN ad_roi END) AS roi88,
    MAX(CASE WHEN date_after = 88 THEN ad_roi END) AS roi89,
    MAX(CASE WHEN date_after = 89 THEN ad_roi END) AS roi90
--     MAX(CASE WHEN date_after = 1 THEN user_retention_ratio END) AS retent1,
--     MAX(CASE WHEN date_after = 2 THEN user_retention_ratio END) AS retent2,
--     MAX(CASE WHEN date_after = 3 THEN user_retention_ratio END) AS retent3,
--     MAX(CASE WHEN date_after = 4 THEN user_retention_ratio END) AS retent4,
--     MAX(CASE WHEN date_after = 5 THEN user_retention_ratio END) AS retent5,
--     MAX(CASE WHEN date_after = 6 THEN user_retention_ratio END) AS retent6,
--     MAX(CASE WHEN date_after = 7 THEN user_retention_ratio END) AS retent7,
--     MAX(CASE WHEN date_after = 8 THEN user_retention_ratio END) AS retent8,
--     MAX(CASE WHEN date_after = 9 THEN user_retention_ratio END) AS retent9,
--     MAX(CASE WHEN date_after = 10 THEN user_retention_ratio END) AS retent10,
--     MAX(CASE WHEN date_after = 11 THEN user_retention_ratio END) AS retent11,
--     MAX(CASE WHEN date_after = 12 THEN user_retention_ratio END) AS retent12,
--     MAX(CASE WHEN date_after = 13 THEN user_retention_ratio END) AS retent13,
--     MAX(CASE WHEN date_after = 14 THEN user_retention_ratio END) AS retent14,
--     MAX(CASE WHEN date_after = 15 THEN user_retention_ratio END) AS retent15,
--     MAX(CASE WHEN date_after = 16 THEN user_retention_ratio END) AS retent16,
--     MAX(CASE WHEN date_after = 17 THEN user_retention_ratio END) AS retent17,
--     MAX(CASE WHEN date_after = 18 THEN user_retention_ratio END) AS retent18,
--     MAX(CASE WHEN date_after = 19 THEN user_retention_ratio END) AS retent19,
--     MAX(CASE WHEN date_after = 20 THEN user_retention_ratio END) AS retent20,
--     MAX(CASE WHEN date_after = 21 THEN user_retention_ratio END) AS retent21,
--     MAX(CASE WHEN date_after = 22 THEN user_retention_ratio END) AS retent22,
--     MAX(CASE WHEN date_after = 23 THEN user_retention_ratio END) AS retent23,
--     MAX(CASE WHEN date_after = 24 THEN user_retention_ratio END) AS retent24,
--     MAX(CASE WHEN date_after = 25 THEN user_retention_ratio END) AS retent25,
--     MAX(CASE WHEN date_after = 26 THEN user_retention_ratio END) AS retent26,
--     MAX(CASE WHEN date_after = 27 THEN user_retention_ratio END) AS retent27,
--     MAX(CASE WHEN date_after = 28 THEN user_retention_ratio END) AS retent28,
--     MAX(CASE WHEN date_after = 29 THEN user_retention_ratio END) AS retent29,
--     MAX(CASE WHEN date_after = 30 THEN user_retention_ratio END) AS retent30,
--     MAX(CASE WHEN date_after = 31 THEN user_retention_ratio END) AS retent31,
--     MAX(CASE WHEN date_after = 32 THEN user_retention_ratio END) AS retent32,
--     MAX(CASE WHEN date_after = 33 THEN user_retention_ratio END) AS retent33,
--     MAX(CASE WHEN date_after = 34 THEN user_retention_ratio END) AS retent34,
--     MAX(CASE WHEN date_after = 35 THEN user_retention_ratio END) AS retent35,
--     MAX(CASE WHEN date_after = 36 THEN user_retention_ratio END) AS retent36,
--     MAX(CASE WHEN date_after = 37 THEN user_retention_ratio END) AS retent37,
--     MAX(CASE WHEN date_after = 38 THEN user_retention_ratio END) AS retent38,
--     MAX(CASE WHEN date_after = 39 THEN user_retention_ratio END) AS retent39,
--     MAX(CASE WHEN date_after = 40 THEN user_retention_ratio END) AS retent40,
--     MAX(CASE WHEN date_after = 41 THEN user_retention_ratio END) AS retent41,
--     MAX(CASE WHEN date_after = 42 THEN user_retention_ratio END) AS retent42,
--     MAX(CASE WHEN date_after = 43 THEN user_retention_ratio END) AS retent43,
--     MAX(CASE WHEN date_after = 44 THEN user_retention_ratio END) AS retent44,
--     MAX(CASE WHEN date_after = 45 THEN user_retention_ratio END) AS retent45,
--     MAX(CASE WHEN date_after = 46 THEN user_retention_ratio END) AS retent46,
--     MAX(CASE WHEN date_after = 47 THEN user_retention_ratio END) AS retent47,
--     MAX(CASE WHEN date_after = 48 THEN user_retention_ratio END) AS retent48,
--     MAX(CASE WHEN date_after = 49 THEN user_retention_ratio END) AS retent49,
--     MAX(CASE WHEN date_after = 50 THEN user_retention_ratio END) AS retent50,
--     MAX(CASE WHEN date_after = 51 THEN user_retention_ratio END) AS retent51,
--     MAX(CASE WHEN date_after = 52 THEN user_retention_ratio END) AS retent52,
--     MAX(CASE WHEN date_after = 53 THEN user_retention_ratio END) AS retent53,
--     MAX(CASE WHEN date_after = 54 THEN user_retention_ratio END) AS retent54,
--     MAX(CASE WHEN date_after = 55 THEN user_retention_ratio END) AS retent55,
--     MAX(CASE WHEN date_after = 56 THEN user_retention_ratio END) AS retent56,
--     MAX(CASE WHEN date_after = 57 THEN user_retention_ratio END) AS retent57,
--     MAX(CASE WHEN date_after = 58 THEN user_retention_ratio END) AS retent58,
--     MAX(CASE WHEN date_after = 59 THEN user_retention_ratio END) AS retent59,
--     MAX(CASE WHEN date_after = 60 THEN user_retention_ratio END) AS retent60,
--     MAX(CASE WHEN date_after = 61 THEN user_retention_ratio END) AS retent61,
--     MAX(CASE WHEN date_after = 62 THEN user_retention_ratio END) AS retent62,
--     MAX(CASE WHEN date_after = 63 THEN user_retention_ratio END) AS retent63,
--     MAX(CASE WHEN date_after = 64 THEN user_retention_ratio END) AS retent64,
--     MAX(CASE WHEN date_after = 65 THEN user_retention_ratio END) AS retent65,
--     MAX(CASE WHEN date_after = 66 THEN user_retention_ratio END) AS retent66,
--     MAX(CASE WHEN date_after = 67 THEN user_retention_ratio END) AS retent67,
--     MAX(CASE WHEN date_after = 68 THEN user_retention_ratio END) AS retent68,
--     MAX(CASE WHEN date_after = 69 THEN user_retention_ratio END) AS retent69,
--     MAX(CASE WHEN date_after = 70 THEN user_retention_ratio END) AS retent70,
--     MAX(CASE WHEN date_after = 71 THEN user_retention_ratio END) AS retent71,
--     MAX(CASE WHEN date_after = 72 THEN user_retention_ratio END) AS retent72,
--     MAX(CASE WHEN date_after = 73 THEN user_retention_ratio END) AS retent73,
--     MAX(CASE WHEN date_after = 74 THEN user_retention_ratio END) AS retent74,
--     MAX(CASE WHEN date_after = 75 THEN user_retention_ratio END) AS retent75,
--     MAX(CASE WHEN date_after = 76 THEN user_retention_ratio END) AS retent76,
--     MAX(CASE WHEN date_after = 77 THEN user_retention_ratio END) AS retent77,
--     MAX(CASE WHEN date_after = 78 THEN user_retention_ratio END) AS retent78,
--     MAX(CASE WHEN date_after = 79 THEN user_retention_ratio END) AS retent79,
--     MAX(CASE WHEN date_after = 80 THEN user_retention_ratio END) AS retent80,
--     MAX(CASE WHEN date_after = 81 THEN user_retention_ratio END) AS retent81,
--     MAX(CASE WHEN date_after = 82 THEN user_retention_ratio END) AS retent82,
--     MAX(CASE WHEN date_after = 83 THEN user_retention_ratio END) AS retent83,
--     MAX(CASE WHEN date_after = 84 THEN user_retention_ratio END) AS retent84,
--     MAX(CASE WHEN date_after = 85 THEN user_retention_ratio END) AS retent85,
--     MAX(CASE WHEN date_after = 86 THEN user_retention_ratio END) AS retent86,
--     MAX(CASE WHEN date_after = 87 THEN user_retention_ratio END) AS retent87,
--     MAX(CASE WHEN date_after = 88 THEN user_retention_ratio END) AS retent88,
--     MAX(CASE WHEN date_after = 89 THEN user_retention_ratio END) AS retent89
from tq_wx_amp_roi r
         join game g on r.app_id = g.app_id
where 1

-- and r.app_id = 'wxe81c4bd460b9a891'
and r.app_id = 'wx2bd39bc6b432744f'
-- and date_at >= '2025-04-04'

GROUP BY r.app_id, date_at

-- having max(ad_cost) > 1000
-- and MAX(CASE WHEN date_after = 29 THEN ad_roi END) > 0
--    and MAX(CASE WHEN date_after = 14 THEN ad_roi END) > 0

order by r.app_id asc, date_at asc
